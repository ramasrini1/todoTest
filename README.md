# ToDoApp
A repo to Todo single page app. (React Front End, Flask(Python) Backend)

## Description
This is a multi user app for creating, maintianing and deleting tasks
This app allows you to create a list of tasks that you want to perform
Once you have finished the task, you can mark it as complete or delete it.
Being a multi user app means, multiple users can use this app and view, update or delete only the tasks that they have created.

## Img of App

![Model](https://github.com/ramasrini1/ToDoApp/blob/main/client/src/Components/assets/todoApp.png)
## Data Source and API
The data for this app will be generated by the users of the app.
The CRUD operations can be performed through the end points of the REST API. 


## Features
* Create, List, Update and deletion of tasks
* User sign in, authentication and authorization
* Restricted page access

## User Flow
* User signs into account with user details
* User logs in using username and passowrd
* User creates the tasks
* Once the task is finished, it can be checked as complete
* User's can check and uncheck the task.
* The task can be deleted from the list

## Tech Stack
* The front end React app (client)
* The backend Flask server.
* Database: PostgreSQL 
* Authentication is implemented using token based
    The token is issued to the user after they provide their credentials 
    (username and password). The token is then sent with each subsequent request to the API, and the API verifies the token's validity to allow or deny access to the requested resource.
    On the client side the token is stored in local storage and this makes the session persistent and avoid losing on refresh.
* Hashed passwords are stored on the db using bcrypt libs
* Functional hooks are used in React frontend to manage state.

## DB Schema
* Two tables are created Users and Todo ( defined in model.py )
* Relatonship the usename from User's table is foreign key to Todo table
* SQL Alchemy ORM models are used to interact with DB

## How to run the application in your local machine
* Download from the git hub link ( or fork)

* To run server
    >cd server
* create virtual environment
    >python3 -m venv venv
    >source venv/bin/activate
    >pip3 install -r requirements.txt
* Create a database in postgres
    >createdb todo
    >psql \c connects to db (cli to postgres)
* Run the seed file to create the tables
    >ipython3 seed.py
* To run flask
* To start the server 
> flask run

## To run the client
* 1) cd client 2) npm install 3) npm start

## API testing through postman
* The end points of the API can be tested through Postman

## API endponts
* Register using Post request
* http://127.0.0.1:5000/api/register
* Request body JSON format
* - { "username": "johndoe", "password": "johndoepass" }
* Returns { msg: "user registration success" status: 200 }

* Login with username and password using Post request
* http://127.0.0.1:5000/login
* Request body JSON format
* { "username": "johndoe", "password": "johndoepass" }

* Returns token with status
* - {
    "status": 200,
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InJhbWExIiwiZXhwIjoxNjc3OTk0NjUwfQ.usVJV8k3YJVBkszA3j3XwanlB0ff7a-BW2nse7nqTxU"
}

* Create a resource, a task using Post request
* http://127.0.0.1:5000/api/add
* Send token in header
* Header data, set the x-access-token to the token recieved from client
* - x-access-token = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InJhbWExIiwiZXhwIjoxNjc3OTk0NjUwfQ.usVJV8k3YJVBkszA3j3XwanlB0ff7a-BW2nse7nqTxU

* Body contains
* { "task_name" : "Do Laundary}
* Response from server
* {
* -    "msg": "todo created successfully",
* -   "status": 200
* }

* View a Resource ( task) 
* Only users who created the task can view it so send the token in the header
* http://127.0.0.1:5000/api/mytodos
* - Use Post or Get request
- Send token in header
* Header data set the x-access-token 
* x-access-token = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9. -eyJ1c2VybmFtZSI6InJhbWExIiwiZXhwIjoxNjc3OTk0NjUwfQ.usVJV8k3YJVBkszA3j3XwanlB0ff7a-BW2nse7nqTxU

* A typical response from  the server
{
    "todos": [
        {
            "complete": false,
            "id": 31,
            "task_name": "Fry Fish",
            "username": "rama1"
        },
        {
            "complete": true,
            "id": 32,
            "task_name": "Take Shower",
            "username": "rama1"
        },
    ]
}

* Update the resource
http://127.0.0.1:5000/api/update/id
- Only the owner can update the resource, token is passed through header and
- username can be extracted from the header in the server.
- Currently the api can update the complete field resource
- We can technically update any field but that features is not implemented in  this api
- Use Post or Get request
- Send token in header
* Header data set the x-access-token to the token recieved from client
x-access-token = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InJhbWExIiwiZXhwIjoxNjc3OTk0NjUwfQ.usVJV8k3YJVBkszA3j3XwanlB0ff7a-BW2nse7nqTxU
{
    "200": "Updated successfully"
}

* Delete the resource
* http://127.0.0.1:5000/api/delete/3
* Post request pass token through the header so only the data is filtered based
on the user sending the request and id, which means only the owner can delete the task
* Response from server
{
    "msg": "Deleted successfully"
}

* Proteced route for testing the token validity
http://127.0.0.1:5000/protected
* If you pass the token in the header. If valid , it will return a succes message.
This route was created to test the authentication/authorization features.



